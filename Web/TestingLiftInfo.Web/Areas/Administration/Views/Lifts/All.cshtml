@using TestingLiftInfo.Common
@model TestingLiftInfo.Web.ViewModels.Administration.Lifts.BigLiftViewModel

@{
    this.ViewData["Title"] = "Регистър";
}

@if (@TempData["CreateLift"] != null)
{
    <div id="newLift" class="alert alert-dismissible alert-success">@TempData["CreateLift"]</div>
}

<h3>@this.ViewData["Title"]</h3>

<div class="row">
    <form asp-area="Administration" asp-controller="Lifts" asp-action="Search" class="col-md-11" method="post">
        <input asp-for="SearchLiftViewModel.RegistrationNumber" type="text" class="form-control-sm text-center" placeholder="Търси по рег. №" size="25" />
        <input asp-for="SearchLiftViewModel.Manufacturer" type="text" class="form-control-sm text-center" placeholder="Търси по произодител" size="25" />
        <input asp-for="SearchLiftViewModel.City" type="text" class="form-control-sm text-center" placeholder="Търси по град или адрес" size="25" />
        <select asp-for="SearchLiftViewModel.IsDeleted" class="form-control-sm text-center">
            <option value="false">✅ Активни</option>
            <option value="true">⛔ Неактивни</option>
        </select>
        <button type="submit" class="btn btn-outline-primary btn-sm" style="margin-bottom:2px; height:28px"><b><i class="fas fa-search"></i> Търси</b></button>
    </form>
    <div>
        <a style="float:right" class=" btn btn-success btn-sm" asp-area="Administration" asp-controller="Lifts" asp-action="Create">✙ Добави</a>
    </div>
</div>
<p></p>
<table class="table table-dark border border-light" style="font-weight:300">
    <thead>
        <tr>
            <th class="border border-light text-light" scope="col" style="text-align:center; width:30px">№</th>
            <th class="border border-light text-light" scope="col" style="text-align:center; width:30px">Статус</th>
            <th class="border border-light text-light" scope="col" style="text-align:center; width:80px">Рег. №</th>
            <th class="border border-light text-light" scope="col" style="text-align:center; width:60px">Тип</th>
            <th class="border border-light text-light" scope="col" style="text-align:center; width:60px">Спирки</th>
            <th class="border border-light text-light" scope="col" style="text-align:center; width:60px">Товароподемност</th>
            <th class="border border-light text-light" scope="col" style="text-align: center ; width:60px">Производител</th>
            <th class="border border-light text-light" scope="col" style="text-align: center">Адрес</th>
        </tr>
    </thead>
    <tbody>
        @{var page = GlobalConstants.NumberOfPrintLifts; }
        @{var count = (Model.GetAllLiftViewModel.CurrentPage - 1) * page + 1;}

        @foreach (var item in Model.GetAllLiftViewModel.Lifts)
        {
            string color = "honeydew";

            if (count % 2 != 0)
            {
                color = "honeydew";
            }
            else
            {
                color = "lightblue";
            }

            <tr class=" text-dark border-light" style="background-color:@color">
                <td class="border border-light" style="text-align:center">@count</td>

                @if (item.IsDeleted == false)
                {
                    <td class="border border-light" style="text-align:center" title="Активен">✅</td>
                }
                else
                {
                    <td class="border border-light" style="text-align:center" title="Неактивен">⛔</td>
                }

                <td class="border border-light">
                    <a href="/Administration/Lifts/Detail/@item.Id" class="text-danger" style="text-align:center">@item.RegistrationNumber</a>
                </td>
                <td class="border border-light">@item.LiftType</td>
                <td class="border border-light" style="text-align:center">@item.NumberOfStops</td>
                <td class="border border-light" style="text-align:center">@item.Capacity</td>
                <td class="border border-light" style="text-align:center">@item.ManufacturerName</td>
                <td class="border border-light">гр. @item.CityName, @item.Address</td>
            </tr>

            count++;
        }
    </tbody>
</table>

<div class="row">
    <div class="col-md-10">
        <nav class="row-cols-5">
            @{var currentPage = Model.GetAllLiftViewModel.CurrentPage; }
            @{var counterPage = Model.GetAllLiftViewModel.PagesCount; }
            <ul class="pagination  pagination-sm justify-content-start">
                @if (currentPage == 1)
                {
                    <li class="page-item disabled">
                        <a class="page-link" href="#">Previous</a>
                    </li>
                }
                else
                {
                    <li class="page-item">
                        <a class="page-link" asp-action="All" asp-route-page="(@currentPage - 1)">Previous</a>
                    </li>
                }

                @for (int i = 1; i <= counterPage; i++)
                {
                    var active = i == currentPage ? "active" : string.Empty;
                    <li class="page-item @active">
                        <a class="page-link" asp-action="All" asp-route-page="@i">@i</a>
                    </li>
                }

                @if (currentPage == counterPage)
                {
                    <li class="page-item disabled">
                        <a class="page-link" href="#">Next</a>
                    </li>
                }
                else
                {
                    <li class="page-item">
                        <a class="page-link" asp-action="All" asp-route-page="@(currentPage + 1)">Next</a>
                    </li>
                }
            </ul>

        </nav>
    </div>

    <div class="col-md-2">
        <a><b>Общ брой: @Model.GetAllLiftViewModel.CountAllLifts</b></a>
    </div>
</div>

<script>
    setTimeout(function () {
        $('#newLift').hide('fade');
    }, 5000);
</script> 